language: python
dist: xenial

python:
- '3.6'
- '3.7'
- '3.8'

env:
- DJANGO_VERSION=2.0.*
- DJANGO_VERSION=2.1.*
- DJANGO_VERSION=2.2.*
- DJANGO_VERSION=3.0.*

script:
- pip install codecov
- pip install -q django==$DJANGO_VERSION
- pip install -e '.[test]'
- coverage run setup.py test
- coverage report -m --fail-under=85
- flake8
- isort --check-only

after_success:
- codecov

deploy:
  provider: pypi
  user: kingbuzzman
  password:
    secure: oBbKEAvhgkw/F2IgT1Qy/lB6lGgmgoM89f0ltIdLne0yd5MwqFiZLA3cTrfwSeHbKPV4GHJWGMSHs+7UkB+ln592WHJvDMU0P6e1ejQ9K/2ksKrmEHLoBnM9V8i5NVAfLRjHMhUJIIG/TgqCHJpMTwpMzckKkGxPIkraWc0W6JKvYjR3gbYZQNfXxZe3+4FaOTjLXrxnYWfePRvH4XeMfw6shaCrbo7ymZAQ7EQ2UYh4XUFQgZjLGxdFhaD8J9CEcVYWRs7EPSfcp9CJJ20UIynX2KI4QCU98BN6WZoZ0/Jq6rO5hZRey7WvICxpfLhP/ZezrPpfU3qg2BHNsBpn0A6cmTOxc02Es2rgG13yUtGf/KnbLZahg0ShbMZ33BBDH3r4uZpvkqps87X9p4Vr6UEjb8sUPPVGRtZLuistIBLBKN2AsAVE9GN6siRMTGy9t0UjwCJhLbeKmeUzgSzSuvl/2hSPxNTTEp2hcTnCaNbbQay6c0ULkNuT8CM1JbbQxbRbsRjk7ogcvxpdYoVtUNImObK3Bbu3uQTf9cJdCbaYtbaXvOtzhGO2hbMRMV1uemMAr8CW+Bl61fYc8bKHipdzElAD/EAdCNY+IAsNuap0RdwLiEq8hZtZTFrNeoutDPO04OPThNtvLfux/0sWa9dke6bHjy+PfYTguBjdEOs=
  on:
    branch: master
